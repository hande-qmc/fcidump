.. TODO: use autodoc
.. .. include:: /autodoc_abbr_options_c.rst
.. .. include:: /autodoc_abbr_options_plugins.rst

FCIDUMP: write out integrals to disk
====================================

.. codeauthor:: James Spencer
.. sectionauthor:: James Spencer

It is sometimes convenient to have a quick interface between |PSIfour| and another code.  One such (albeit inefficient) way is to write out all one- and two-electron integrals to disk.  A format (sadly modified in an ad hoc fashion by other codes) for the filetype FCIDUMP is given in Comp. Phys. Commun. 54 (1989) 75.

The FCIDUMP format starts with a Fortran namelist (delimited by &FCI and &END) with the following options:

NORB
    Integer.  The number of orbitals.
NELEC
    Integer.  The number of electrons.
MS2
    Integer.  The spin polarization of the system, :math:`2 \time M_s`.
ORBSYM
    Integer list.  A comma-separated list containing the symmetry label of each orbital.  See below for more details.
UHF
    Boolean.  True if underlying SCF calculation is UHF and False if it is RHF.

.. note::

    The number of and indices of orbitals refer to molecular orbitals if generated by an RHF calculation and to spin orbitals if generated by a UHF calculation.

The integrals are printed (one per line) after the namelist in the following format::

    x  i  a  j  b

The following cases are permitted:

i, j, a, b are all zero
    x is the nuclear energy (plus the contribution from the frozen core orbitals, if applicable)
a, j, b are both zero
    x is the energy of the i-th orbital
j, b are both zero
    x is the one-body Hamiltonian operator integral between i and a, :math:`\langle i | h | a \rangle = x`.
i, a, j, b are all non-zero
    x is the Coulomb integral, :math:`( i a | j b ) = x`.

Symmetry labels
---------------

A symmetry label corresponds to an irreducible representation of the largest Abelian subgroup of the molecule, as given in Sec. :ref:`sec:symmetry`.

In a zero-indexed scheme (i.e. subtract one from each label), the exclusive or between symmetry labels of two irreducible representations gives the label of irreducible representation which is the result of the direct product of the first two irreducible representations.  This is extremely convenient as it avoids needing to know the ordering of the representations or indeed what representation each label corresponds to...

Example
-------

::

    sys.path.insert(0, '/path/to/plugins')
    import fcidump

    molecule {
       Ne  0  0  0
    }

    set {
        basis 6-311g
        scf_type out_of_core
        freeze_core small
        num_frozen_uocc 4
    }

    energy('fcidump')

will run the requested SCF calculation and then write out an FCIDUMP file.

Basic keywords
--------------

|integrals_file|
    Filename to which the integrals are written.  Default: INTDUMP.
